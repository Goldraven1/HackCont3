# 2. Техническое описание

## 2.1 Стек технологий

### Backend
Промышленное решение основано на современном и надежном технологическом стеке:

#### Core Backend Framework
- **Django 4.2+** (LTS версия)
  - Основной фреймворк для бизнес-логики
  - Django ORM для работы с базой данных
  - Django Admin для административных задач
  - Django REST Framework для API
  - Встроенная система безопасности и аутентификации

#### API Framework
- **FastAPI 0.104+**
  - Высокопроизводительный асинхронный API
  - Автоматическая генерация OpenAPI/Swagger документации
  - Валидация данных с помощью Pydantic
  - WebSocket поддержка для real-time функций
  - Интеграция с Django через общую базу данных

#### База данных
- **PostgreSQL 15+** (основная СУБД)
  - Поддержка JSON полей для гибких данных
  - PostGIS расширение для геолокационных данных
  - Репликация для высокой доступности
- **Redis 7+** (кэширование и сессии)
  - Кэширование API ответов
  - Хранение сессий пользователей
  - Message broker для фоновых задач

#### Дополнительные Backend компоненты
- **Celery** - Асинхронная обработка задач
- **Django Channels** - WebSocket соединения
- **Gunicorn/Uvicorn** - ASGI/WSGI серверы
- **Pillow** - Обработка изображений
- **ReportLab** - Генерация PDF отчетов
- **python-docx** - Работа с документами Word

### Frontend
Промышленный фронтенд с возможностью масштабирования:

#### Core Technologies
- **HTML5** - Семантическая разметка
- **CSS3** - Стилизация и адаптивный дизайн
- **Vanilla JavaScript (ES6+)** - Основная логика интерфейса

#### CSS Framework & Libraries
- **Bootstrap 5.3+** - Адаптивная сетка и компоненты
- **Font Awesome 6+** - Иконки
- **Chart.js 4+** - Интерактивные графики и диаграммы
- **Leaflet.js** - Интерактивные карты для геолокации

#### JavaScript Libraries
- **Axios** - HTTP клиент для API запросов
- **Moment.js** - Работа с датами и временем
- **Socket.IO** - Real-time коммуникация
- **jQuery 3.7+** - DOM манипуляции (постепенный отказ)
- **Dropzone.js** - Загрузка файлов drag-and-drop
- **Select2** - Расширенные выпадающие списки

#### Дополнительные Frontend компоненты
- **PWA Support** - Service Workers для офлайн работы
- **Web Push API** - Уведомления
- **File API** - Работа с файлами
- **Geolocation API** - Определение координат

### DevOps & Infrastructure

#### Контейнеризация
- **Docker** - Контейнеризация приложений
- **Docker Compose** - Локальная разработка
- **Kubernetes** - Оркестрация в продакшене

#### CI/CD
- **GitHub Actions** - Автоматизация сборки и деплоя
- **Nginx** - Reverse proxy и статические файлы
- **Let's Encrypt** - SSL сертификаты

#### Мониторинг
- **Prometheus** - Сбор метрик
- **Grafana** - Визуализация метрик
- **Sentry** - Отслеживание ошибок
- **ELK Stack** - Логирование

## 2.2 Архитектура системы

### 2.2.1 Микросервисная архитектура

Система построена по принципу микросервисной архитектуры для обеспечения масштабируемости и надежности:

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │   API Gateway   │    │   Auth Service  │
│   (HTML/CSS/JS) │◄──►│   (Nginx)       │◄──►│   (Django)      │
└─────────────────┘    └─────────────────┘    └─────────────────┘
                                │
                ┌───────────────┼───────────────┐
                │               │               │
        ┌───────▼──────┐ ┌──────▼──────┐ ┌─────▼──────┐
        │ Core Service │ │ File Service│ │ GIS Service│
        │ (Django)     │ │ (FastAPI)   │ │ (FastAPI)  │
        └───────┬──────┘ └──────┬──────┘ └─────┬──────┘
                │               │              │
        ┌───────▼──────┐ ┌──────▼──────┐ ┌─────▼──────┐
        │ PostgreSQL   │ │ File Storage│ │ PostGIS DB │
        │ (Main DB)    │ │ (MinIO/S3)  │ │ (Geo Data) │
        └──────────────┘ └─────────────┘ └────────────┘
```

### 2.2.2 Компоненты системы

#### Core Service (Django)
- **Функции**: Основная бизнес-логика, пользователи, права доступа
- **Технологии**: Django 4.2+, PostgreSQL, Redis
- **API**: Django REST Framework
- **Особенности**: Административная панель, ORM, миграции

#### File Service (FastAPI)
- **Функции**: Загрузка, обработка и хранение файлов
- **Технологии**: FastAPI, MinIO/S3, Celery
- **API**: RESTful с автоматической документацией
- **Особенности**: Асинхронная обработка, оптимизация изображений

#### GIS Service (FastAPI)
- **Функции**: Геолокационные данные, карты, координаты
- **Технологии**: FastAPI, PostGIS, Leaflet.js
- **API**: Геоспациальные запросы
- **Особенности**: Проверка местоположения, карты объектов

#### Authentication Service (Django)
- **Функции**: Аутентификация, авторизация, управление ролями
- **Технологии**: Django, JWT, OAuth2
- **API**: Token-based authentication
- **Особенности**: Интеграция с ЕСИА, двухфакторная аутентификация

---

*Документ описывает промышленную архитектуру системы электронного журнала производства работ*
